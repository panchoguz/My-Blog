[
  {
    "path": "posts/2021-04-11-wdi/",
    "title": "Paquete WDI",
    "description": "Comparación del PIB per cápita real (PPA) entre países. Datos: Banco Mundial (utilizando paquete WDI).",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2021-04-12",
    "categories": [
      "WDI",
      "dplyr",
      "ggplot2",
      "ggthemes",
      "Cairo",
      "scales"
    ],
    "contents": "\r\n\r\nContents\r\nLibrerías\r\nBase de Datos\r\nBúsqueda\r\nDescarga\r\nModificaciones\r\nunique()/filter()\r\nrename()\r\nmutate()/recode()\r\n\r\nAnálisis\r\n\r\nGráfico\r\nCódigo\r\nReferencias\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nLibrerías\r\n\r\n\r\nlibrary(WDI)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(ggthemes)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\n\r\n\r\n\r\nBase de Datos\r\nBúsqueda\r\nEl comando WDIsearch() se utiliza para buscar las bases de interés con palabras clave. En este caso, estamos interesados en comparar el PIB per cápita real de Chile, medido a PPP, por lo que nuestras palabras claves serán gdp, ppp y constant. Lo anterior se traduce en lo siguiente:\r\n\r\n\r\nWDIsearch('gdp.*ppp.*constant')\r\n\r\n\r\n     indicator             \r\n[1,] \"6.0.GDPpc_constant\"  \r\n[2,] \"NY.GDP.MKTP.PP.KD\"   \r\n[3,] \"NY.GDP.MKTP.PP.KD.87\"\r\n[4,] \"NY.GDP.PCAP.PP.KD\"   \r\n[5,] \"NY.GDP.PCAP.PP.KD.87\"\r\n     name                                                  \r\n[1,] \"GDP per capita, PPP (constant 2011 international $) \"\r\n[2,] \"GDP, PPP (constant 2017 international $)\"            \r\n[3,] \"GDP, PPP (constant 1987 international $)\"            \r\n[4,] \"GDP per capita, PPP (constant 2017 international $)\" \r\n[5,] \"GDP per capita, PPP (constant 1987 international $)\" \r\n\r\nDadas las 5 opciones que nos muestra el resultado, para efectos de este artículo, nos quedaremos con la número 4: “GDP per capita, PPP (constant 2017 international $)”.\r\nDescarga\r\nCon el siguiente comando podemos obtener la base y aplicar filtros previos.\r\n\r\n\r\ndf <- WDI(\r\n  country = \"all\",\r\n  indicator = \"NY.GDP.PCAP.PP.KD\",\r\n  start = 1990,\r\n  end = 2020,\r\n  extra = FALSE,\r\n  cache = NULL,\r\n  latest = NULL,\r\n  language = \"es\"\r\n)\r\n\r\n\r\n\r\nModificaciones\r\nunique()/filter()\r\nCon el comando unique() vemos los códigos de los países para hacer la selección y después aplicamos filter().\r\n\r\n\r\nunique(df[c(\"iso2c\", \"country\")])\r\n\r\n\r\n\r\n\r\n\r\ndf <- filter(df, iso2c %in% c(\"ZJ\", \"AU\", \"CL\", \"NZ\", \"NO\", \"US\"))\r\n\r\n\r\n\r\nrename()\r\nCon rename() podemos modificar el nombre de las variables.\r\n\r\n\r\ndf <- rename(df, gdp_pc = NY.GDP.PCAP.PP.KD)\r\n\r\n\r\n\r\nmutate()/recode()\r\nCon estos comandos podemos cambiar los nombres de las categorías.\r\n\r\n\r\ndf <- df %>% mutate(country = recode(country,\r\n                            \"AmÃ©rica Latina y el Caribe\" = \"América Latina y el Caribe\"))\r\n\r\n\r\n\r\nAnálisis\r\nAnalizamos el ranking de los países según PIB per cápita para el año 2019.\r\n\r\n\r\ndf %>% \r\n  filter(year == 2019) %>%\r\n  select(country, gdp_pc) %>%\r\n  arrange(-gdp_pc) %>% \r\n  head(6)\r\n\r\n\r\n                     country   gdp_pc\r\n1                    Noruega 64962.26\r\n2             Estados Unidos 62530.39\r\n3                  Australia 49611.86\r\n4             Nueva Zelandia 43695.15\r\n5                      Chile 25131.46\r\n6 América Latina y el Caribe 16375.60\r\n\r\nComparamos el PIB per cápita de Chile con Nueva Zelandia en 1990 y 2015.\r\n\r\n\r\ndf %>% \r\n  filter(year %in% c(1990,2015) & iso2c %in% c(\"CL\",\"NZ\")) %>%\r\n  select(country, year, gdp_pc)\r\n\r\n\r\n         country year    gdp_pc\r\n1          Chile 2015 24516.837\r\n2          Chile 1990  9880.441\r\n3 Nueva Zelandia 2015 41229.259\r\n4 Nueva Zelandia 1990 28135.652\r\n\r\nGráfico\r\n\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(df, aes(year, gdp_pc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"PIB per cápita, PPA($ a precios internacionales constantes de 2017)\",\r\n       subtitle = \"Período 1990-2019\",\r\n       caption = \"Fuente: Elaboración propia en base a datos del Banco Mundial\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1990,2020, by = 5)) +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_fivethirtyeight() +\r\n  theme(plot.title = element_text(size = rel(1.05)),\r\n        plot.subtitle = element_text(size = rel(.9), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 0, vjust=1, size = 8),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 8),\r\n        legend.position = \"bottom\",\r\n        panel.grid.major = element_line(colour = \"white\"))\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nCódigo\r\n\r\n\r\nlibrary(WDI)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(ggthemes)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\n\r\nWDIsearch('gdp.*ppp.*constant')\r\n\r\ndf <- WDI(\r\n  country = \"all\",\r\n  indicator = \"NY.GDP.PCAP.PP.KD\",\r\n  start = 1990,\r\n  end = 2020,\r\n  extra = FALSE,\r\n  cache = NULL,\r\n  latest = NULL,\r\n  language = \"es\"\r\n)\r\n\r\nunique(df[c(\"iso2c\", \"country\")])\r\ndf <- filter(df, iso2c %in% c(\"ZJ\", \"AU\", \"CL\", \"NZ\", \"NO\", \"US\"))\r\n\r\ndf <- rename(df, gdp_pc = NY.GDP.PCAP.PP.KD)\r\n\r\ndf <- df %>% mutate(country = recode(country,\r\n                            \"AmÃ©rica Latina y el Caribe\" = \"América Latina y el Caribe\"))\r\ndf %>% \r\n  filter(year == 2019) %>%\r\n  select(country, gdp_pc) %>%\r\n  arrange(-gdp_pc) %>% \r\n  head(6)\r\n\r\ndf %>% \r\n  filter(year %in% c(1990,2015) & iso2c %in% c(\"CL\",\"NZ\")) %>%\r\n  select(country, year, gdp_pc)\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(df, aes(year, gdp_pc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"PIB per cápita, PPA($ a precios internacionales constantes de 2017)\",\r\n       subtitle = \"Período 1990-2019\",\r\n       caption = \"Fuente: Elaboración propia en base a datos del Banco Mundial\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1990,2020, by = 5)) +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_fivethirtyeight() +\r\n  theme(plot.title = element_text(size = rel(1.05)),\r\n        plot.subtitle = element_text(size = rel(.9), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 0, vjust=1, size = 8),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 8),\r\n        legend.position = \"bottom\",\r\n        panel.grid.major = element_line(colour = \"white\"))\r\n\r\n# Para guardar en formato png\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\n\r\n# Para guardar con más calidad (pdf o eps)\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\n\r\nggsave(g1, filename = \"plot.eps\", device = cairo_ps, dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\nknitr::include_graphics(\"plot.png\")\r\n\r\n\r\n\r\nReferencias\r\nggplot2\r\nWDI\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-11-wdi/plot.png",
    "last_modified": "2021-04-12T10:45:31-04:00",
    "input_file": "wdi.utf8.md",
    "preview_width": 2125,
    "preview_height": 1594
  },
  {
    "path": "posts/2021-04-12-maddison-project-database-2020/",
    "title": "Maddison Project Database 2020",
    "description": "Trabajaremos con los datos proporcionados por el Proyecto Maddison y realizaremos un gráfico que nos muestre el crecimiento del PIB per cápita de los países seleccionados.",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2021-04-12",
    "categories": [
      "Cairo",
      "dplyr",
      "ggplot2",
      "ggthemes",
      "readxl",
      "scales"
    ],
    "contents": "\r\n\r\nContents\r\nLibrerías\r\nBase de Datos\r\nImportamos\r\nunique()\r\ntapply()\r\nfilter()\r\n\r\nGráfico\r\nCódigo\r\nReferencias\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nLibrerías\r\n\r\n\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\nlibrary(dplyr)\r\n\r\n\r\n\r\nBase de Datos\r\nImportamos\r\nObtenemos la base desde Maddison Project Database 2020. Luego, la importamos.\r\n\r\n\r\nmpd2020 <- as.data.frame(read_excel(\"mpd2020.xlsx\", sheet = \"Full data\"))\r\n\r\n\r\n\r\nunique()\r\nEl siguiente comando puede ser útil para realizar la selección de países. En este caso, compararemos el crecimiento de Chile con el de Noruega, Suecia, Finlandia, Nueva Zelanda y Australia.\r\n\r\n\r\nunique(mpd2020[c(\"countrycode\", \"country\")])\r\n\r\n\r\n\r\ntapply()\r\nCon el siguiente comando nos interesa ver el período que comprenderá el gráfico, tomando en cuenta los datos disponibles para Chile.\r\n\r\n\r\n  mpd2020 %>% \r\n  filter(countrycode == \"CHL\") %>%\r\n  summary()\r\n\r\n\r\n\r\nVemos que hay datos para Chile desde 1800, por lo que el gráfico iniciará desde ese año.\r\nfilter()\r\nDada la información de los dos pasos anteriores, filtramos la base para dejarla con lo que necesitamos. Podemos crear una nueva por si llegáramos a necesitar la base completa para alguna otra cosa.\r\n\r\n\r\ndf_graf1 <- mpd2020 %>%\r\n  filter(countrycode %in% c(\"CHL\", \"NOR\", \"SWE\", \"FIN\", \"NZL\", \"AUS\"),\r\n         year>=1800)\r\n\r\n\r\n\r\nGráfico\r\n\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(data = df_graf1, aes(year, gdppc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"International Comparison of Real GDP per capita in 2011$\",\r\n       subtitle = \"1800-2018\",\r\n       caption = \"Source: Personal elaboration with Maddison Project Database 2020\",\r\n       x = \"\",\r\n       y = \"\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1800,2020, by = 10), position = \"bottom\") +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_tufte() +\r\n  theme(plot.title = element_text(size = rel(1.2)),\r\n        plot.subtitle = element_text(size = rel(1), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 90, vjust=.5, size = 8),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 8),\r\n        axis.ticks.x = element_line(size = 0),\r\n        axis.ticks.y = element_blank(),\r\n        panel.grid.major.y = element_line(colour = \"grey90\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey90\"))\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nknitr::include_graphics(\"plot.png\")\r\n\r\n\r\n\r\n\r\nCódigo\r\n\r\n\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\nlibrary(dplyr)\r\n\r\nmpd2020 <- as.data.frame(read_excel(\"mpd2020.xlsx\", sheet = \"Full data\"))\r\n\r\nunique(mpd2020[c(\"countrycode\", \"country\")])\r\n\r\n  mpd2020 %>% \r\n  filter(countrycode == \"CHL\") %>%\r\n  summary()\r\ndf_graf1 <- mpd2020 %>%\r\n  filter(countrycode %in% c(\"CHL\", \"NOR\", \"SWE\", \"FIN\", \"NZL\", \"AUS\"),\r\n         year>=1800)\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(data = df_graf1, aes(year, gdppc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"International Comparison of Real GDP per capita in 2011$\",\r\n       subtitle = \"1800-2018\",\r\n       caption = \"Source: Personal elaboration with Maddison Project Database 2020\",\r\n       x = \"\",\r\n       y = \"\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1800,2020, by = 10), position = \"bottom\") +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_tufte() +\r\n  theme(plot.title = element_text(size = rel(1.2)),\r\n        plot.subtitle = element_text(size = rel(1), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 90, vjust=.5, size = 8),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 8),\r\n        axis.ticks.x = element_line(size = 0),\r\n        axis.ticks.y = element_blank(),\r\n        panel.grid.major.y = element_line(colour = \"grey90\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey90\"))\r\n# Para guardar en formato png\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\n\r\n# Para guardar con más calidad (pdf o eps)\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\n\r\nggsave(g1, filename = \"plot.eps\", device = cairo_ps, dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\nknitr::include_graphics(\"plot.png\")\r\n\r\n\r\n\r\nReferencias\r\nggplot2\r\nMaddison Project Database 2020\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-12-maddison-project-database-2020/distill-preview.png",
    "last_modified": "2021-04-12T15:47:40-04:00",
    "input_file": "maddison-project-database-2020.utf8.md",
    "preview_width": 2125,
    "preview_height": 1594
  },
  {
    "path": "posts/2021-04-08-evolucin-del-precio-del-cobre/",
    "title": "Evolución precio del cobre",
    "description": "Construcción de un gráfico con indicaciones paso por paso. Datos: Cochilco.",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2021-04-11",
    "categories": [
      "ggplot2",
      "tidyverse"
    ],
    "contents": "\r\n\r\nContents\r\nPaso a paso\r\nBase de datos\r\nLibrerías\r\nImportamos base\r\nGráfico\r\nggplot()/geom_line()\r\nlabs()\r\ntheme_minimal()\r\ntheme()\r\nannotate()\r\ngeom_point()/geom_text()\r\nannotate()\r\ngeom_hline()/geom_text\r\n\r\n\r\nCódigo gráfico\r\nReferencias\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nPaso a paso\r\nBase de datos\r\nDebemos ir a Precios de los Metales e Inventarios y descargar los datos. En este caso, trabajaremos con el precio mensual del período Ene2000-Mar2021 (LME).\r\nLibrerías\r\nDeben haber sido previamente instaladas con el comando install.packages().\r\n\r\n\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(tidyverse)\r\n\r\n\r\n\r\n\r\n\r\n\r\nImportamos base\r\nDebemos fijarnos en que la base esté guardada en formato .xlsx, al decargarla puede haber quedado en algún otro formato. Luego de importar, realizamos algunas modificaciones.\r\n\r\n\r\ndf <- read_excel(\"datos.xlsx\")\r\n\r\nnames(df)[1] <- \"Fecha\"\r\nnames(df)[2] <- \"Precio\"\r\n\r\ndf$Fecha <- as.Date(df$Fecha)\r\n\r\n\r\n\r\nGráfico\r\nggplot()/geom_line()\r\nComenzamos con un gráfico simple.\r\n\r\n\r\ngraph <- ggplot(data = df, aes(Fecha, Precio)) +\r\n  geom_line(colour = \"navy\")\r\ngraph\r\n\r\n\r\n\r\n\r\nlabs()\r\nPodemos agregar título, subtítulo, entre otras cosas.\r\n\r\n\r\ngraph <- graph + labs(title = \"Precio Nominal Cobre Mensual (¢/lb)\",\r\n                     subtitle = \"Período 2000-2021\",\r\n       caption = \"Fuente: Elaboración propia en base a datos de Cochilco\",\r\n       tag = \"\",\r\n       x = \"\",\r\n       y = \"\")\r\ngraph\r\n\r\n\r\n\r\n\r\ntheme_minimal()\r\nAñadimos un tema. Ver más opciones en Complete themes.\r\n\r\n\r\ngraph <- graph + theme_minimal()\r\ngraph\r\n\r\n\r\n\r\n\r\ntheme()\r\nEditamos el tema: tamaño del título, subtítulo, fuente, margen, etc. Ver Modify components of a theme para más detalles.\r\n\r\n\r\ngraph <- graph +\r\n  theme(plot.title = element_text(size = rel(1.35)),\r\n        plot.subtitle = element_text(size = rel(1), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"))\r\ngraph\r\n\r\n\r\n\r\n\r\nannotate()\r\nAgregamos un rectángulo sombreado para identificar algún período más relevante dentro del gráfico.\r\n\r\n\r\ngraph <- graph +\r\n  annotate(\"rect\", fill = \"darkgreen\", alpha = 0.2,\r\n           xmin = as.Date(\"2009-11-01\"), xmax = as.Date(\"2013-05-01\"),\r\n           ymin = -Inf, ymax = Inf)\r\ngraph\r\n\r\n\r\n\r\n\r\ngeom_point()/geom_text()\r\nPodemos identificar un punto máximo y colocar una etiqueta. Creamos graph2 porque no añadiremos esto en nuestro gráfico pirncipal.\r\n\r\n\r\npmax <- df %>% #precio máximo\r\n  slice(which.max(Precio))\r\n\r\ngraph2 <- graph +\r\n  geom_point(data = pmax, aes(x = Fecha, y = Precio), col = \"red\",\r\n             shape = 21, fill = NA, size = 4, stroke = 1.1) +\r\n  geom_text(data = pmax, aes(x = Fecha, y = Precio,\r\n                label = sprintf(\"%0.1f\", round(Precio, digits = 3))),\r\n            size = 2.5, vjust = 0, hjust = -0.5)\r\ngraph2\r\n\r\n\r\n\r\n\r\nannotate()\r\nVolvemos a utilizar graph. Añadimos un texto con información adicional sobre el período destacado. Ver Create an annotation layer para más detalles.\r\n\r\n\r\ngraph <- graph + \r\n  annotate(geom=\"text\",x=as.Date(\"2011-08-01\"),\r\n           y=490, label=\"superciclo 09'-13'\", fontface=\"plain\", size=3)\r\ngraph\r\n\r\n\r\n\r\n\r\ngeom_hline()/geom_text\r\nFinalmente, podemos agregar una línea con el valor actual del cobre (el más reciente en los datos descargados) y crear la etiqueta correspondiente.\r\n\r\n\r\nplast <- df %>% #precio más reciente\r\n  slice(which.max(Fecha))\r\n\r\ngraph <- graph +\r\n  geom_hline(yintercept = tail(df$Precio, n=1), linetype=\"dashed\",\r\n             color = \"red\", size = .5) +\r\n  geom_text(data = plast,\r\n            aes(x = Fecha, y = Precio,\r\n                label = sprintf(\"%0.1f\", round(Precio, digits = 3))), size = 3,\r\n            vjust = -.5, hjust = .5, col = \"red\")\r\ngraph\r\n\r\n\r\n\r\n\r\nCódigo gráfico\r\n\r\n\r\nplast <- df %>% #precio más reciente\r\n  slice(which.max(Fecha))\r\n\r\nggplot(data = df, aes(Fecha, Precio)) +\r\n  geom_line(colour = \"navy\")+ \r\n  labs(title = \"Precio Nominal Cobre Mensual (¢/lb)\",\r\n                      subtitle = \"Período 2000-2021\",\r\n                      caption = \"Fuente: Elaboración propia en base a datos de Cochilco\",\r\n                      tag = \"\",\r\n                      x = \"\",\r\n                      y = \"\") + \r\n  theme_minimal() +\r\n  theme(plot.title = element_text(size = rel(1.35)),\r\n        plot.subtitle = element_text(size = rel(1), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\")) +\r\n  annotate(\"rect\", fill = \"darkgreen\", alpha = 0.2,\r\n           xmin = as.Date(\"2009-11-01\"), xmax = as.Date(\"2013-05-01\"),\r\n           ymin = -Inf, ymax = Inf) +\r\n  annotate(geom=\"text\",x=as.Date(\"2011-08-01\"),\r\n           y=490, label=\"superciclo 09'-13'\", fontface=\"plain\", size=3) +\r\n  geom_hline(yintercept = tail(df$Precio, n=1), linetype=\"dashed\",\r\n             color = \"red\", size = .5) +\r\n  geom_text(data = plast,\r\n            aes(x = Fecha, y = Precio,\r\n                label = sprintf(\"%0.1f\", round(Precio, digits = 3))), size = 3,\r\n            vjust = -.5, hjust = .5, col = \"red\")\r\n\r\n\r\n\r\nReferencias\r\nggplot2\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-08-evolucin-del-precio-del-cobre/Rplot01.png",
    "last_modified": "2021-04-11T11:50:34-04:00",
    "input_file": {},
    "preview_width": 495,
    "preview_height": 332
  },
  {
    "path": "posts/2021-04-07-ps-1/",
    "title": "Tasa de sindicalización",
    "description": "Construcción de un gráfico con la tasa de sindicalización de algunos países OCDE, período 2000-2018. Datos: library(OECD).",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2021-04-10",
    "categories": [
      "Eco Laboral",
      "OECD",
      "tidyverse",
      "Hmisc",
      "skimr"
    ],
    "contents": "\r\n\r\nContents\r\nPaso a paso\r\nLibrerías\r\nAnálisis de la base\r\nGráfico\r\n\r\nCódigo\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nPaso a paso\r\nLibrerías\r\n\r\n\r\nlibrary(OECD)\r\nlibrary(tidyverse)\r\nlibrary(Hmisc)\r\nlibrary(skimr)\r\n\r\n\r\n\r\nAnálisis de la base\r\nLa base la obtendremos desde la librería OECD. A menos que conozcamos la sigla exacta de la base a utilizar, se recomienda crear un dataframe, que nombraremos df, con todas las bases disponibles que nos otorga la librería OECD y buscar en este la base que queramos. Para esto último, buscaremos “union”, dado que en inglés a los sindicatos se les denomina trade union.\r\n\r\n\r\ndf <- get_datasets()\r\nsearch_dataset(\"union\", data = df)\r\n\r\n\r\n# A tibble: 2 x 2\r\n  id    title                                                 \r\n  <chr> <chr>                                                 \r\n1 TUD   Trade Union                                           \r\n2 REVEU [Discontinued] VAT and Customs duties - European Union\r\n\r\nIdentificamos nuestra base de interés (TUD), la descargamos y la exploramos. Para esto último, utilizamos el comando skim() y describe().\r\n\r\n\r\ndf <- get_dataset(\"TUD\")\r\n\r\nskim(df)\r\ndescribe(df)\r\n\r\n\r\n\r\nLuego del análisis, realizamos algunos filtros para quedarnos con las variables y categorías de interés. Seleccionamos algunos países, un período más acotado y la unidad con que trabajaremos (PC, por porcentaje).\r\n\r\n\r\ndf <- subset(df, select = c(\"COU\", \"SOURCE\", \"UNIT\", \"obsTime\", \"obsValue\")) %>%\r\n  filter(COU %in% c(\"CHL\", \"GRC\", \"POL\", \"TUR\"), UNIT == \"PC\", obsTime>2000)\r\n\r\n\r\n\r\nGráfico\r\n\r\n\r\nggplot(df, aes(obsTime, obsValue, group = COU)) +\r\n  geom_line(aes(color = COU)) +\r\n  labs(title = \"Tasa de Sindicalización\", subtitle = \"Período 2000-2018\", caption = \"Fuente: Elaboración propia\") +\r\n  xlab(\"Año\") + ylab(\"Tasa (%)\") + scale_x_discrete(breaks = c(2001, 2005, 2009, 2013, 2017)) +\r\n  scale_y_continuous(limits = c(0, 30)) + theme_minimal()\r\n\r\n\r\n\r\n\r\nCódigo\r\n\r\n\r\nlibrary(OECD)\r\nlibrary(tidyverse)\r\nlibrary(Hmisc)\r\nlibrary(skimr)\r\n\r\n\r\ndf <- get_datasets()\r\nsearch_dataset(\"union\", data = df)\r\n\r\n\r\ndf <- get_dataset(\"TUD\")\r\n\r\nskim(df)\r\ndescribe(df)\r\n\r\n\r\ndf <- subset(df, select = c(\"COU\", \"SOURCE\", \"UNIT\", \"obsTime\", \"obsValue\")) %>%\r\n  filter(COU %in% c(\"CHL\", \"GRC\", \"POL\", \"TUR\"), UNIT == \"PC\", obsTime>2000)\r\n\r\nggplot(df, aes(obsTime, obsValue, group = COU)) +\r\n  geom_line(aes(color = COU)) +\r\n  labs(title = \"Tasa de Sindicalización\", subtitle = \"Período 2000-2018\", caption = \"Fuente: Elaboración propia\") +\r\n  xlab(\"Año\") + ylab(\"Tasa (%)\") + scale_x_discrete(breaks = c(2001, 2005, 2009, 2013, 2017)) +\r\n  scale_y_continuous(limits = c(0, 30)) + theme_minimal()\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-07-ps-1/distill-preview.png",
    "last_modified": "2021-04-10T16:57:59-04:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  }
]
